{% extends "pages/abstract/mainsite.html.twig" %}

{% set page_active = "home" %}

{# Overrides blocks in head of base template #}
{% block page_title %}{{ translate("HOME") }}{% endblock %}

{% block page_description %}{{ translate("WELCOME_TO", {'title': site.title}) }}{% endblock %}

{% block content %}
    <div class="main">
        <div class="MainTabWindows">

            <div class="carousel-cell FeedTab">
                <div class="headerWrap">
                    <div class="header">
                        <span class="LeftButtonHeader"><i class="fas fa-bars"></i></span>
                        <span class="HeaderCaption">{{ translate("TAB_CAPTIONS.FEED") }}</span>
                        <span id="ImageUploadButton" class="RightButtonHeader"><i class="fas fa-upload"></i></span>
                    </div>
                    <hr>
                </div>
                <div class="MainInTab FeedTabWindow">
                    {% for FeedImage in FeedImages %}
                        <img class="FeedImage" src="{{ site.uri.public }}/image/{{ FeedImage.PostID }}">
                        <br>
                    {% endfor %}
                </div>
            </div>

            <div class="carousel-cell ExploreTab">
                <div class="headerWrap">
                    <div class="header">
                        <span class="LeftButtonHeader"><i class="fas fa-bars"></i></span>
                        <span class="HeaderCaption">{{ translate("TAB_CAPTIONS.EXPLORE") }}</span>
                        <span class="RightButtonHeader"><i class="fas fa-bell"></i></span>
                    </div>
                    <hr>
                </div>
                <div class="MainInTab ExploreTabWindow">
                    <input id="UserSearchBar" class="UserSearchBar" type="text"
                           title="{{ translate("EXPLORE_TAB.USER_SEARCH_PH") }}"
                           placeholder="{{ translate("EXPLORE_TAB.USER_SEARCH_PH") }}">
                    <br>
                    <div id="alerts-page"></div>
                    <div class="SearchResults">
                    </div>
                    <div id="ExploreData">

                    </div>
                </div>
            </div>

            <div class="carousel-cell ChatTab">
                <div class="headerWrap">
                    <div class="header">
                        <span class="LeftButtonHeader"><i class="fas fa-bars"></i></span>
                        <span class="HeaderCaption TabCaption">{{ translate("TAB_CAPTIONS.CHAT") }}</span>
                        <span class="RightButtonHeader"><i class="fas fa-bell"></i></span>
                    </div>
                    <hr class="ChatHeaderDivider">
                </div>
                <div class="MainInTab ChatWindow">
                    <div class="SelectReceiver"></div>
                    <div class="SelectedReceiver">
                        {#
                        <div id="ChatMessages" class="ChatMessages" data-username="">
                            <!-- Messages -->
                        </div>
                        #}
                        <input title="{{ translate("CHAT_MESSAGES.WRITE_MESSAGE_PH") }}"
                               placeholder="{{ translate("CHAT_MESSAGES.WRITE_MESSAGE_PH") }}"
                               id="ChatTextInput" class="ChatInput" type="text" />
                    </div>
                </div>
            </div>

            <div class="carousel-cell FriendsTab">
                <div class="headerWrap">
                    <div class="header">
                        <span class="LeftButtonHeader"><i class="fas fa-bars"></i></span>
                        <span class="HeaderCaption">{{ translate("TAB_CAPTIONS.FRIENDS") }}</span>
                        <span class="RightButtonHeader"><i class="fas fa-bell"></i></span>
                    </div>
                    <hr>
                </div>
                <div class="MainInTab FriendsTabWindow">
                    <div class="FriendList">
                    </div>
                </div>
            </div>

            <div class="carousel-cell PersonalTab">
                <div class="headerWrap">
                    <div class="header">
                        <span class="LeftButtonHeader"><i class="fas fa-bars"></i></span>
                        <span class="HeaderCaption">{{ translate("TAB_CAPTIONS.PERSONAL") }}</span>
                        <span class="RightButtonHeader"><i class="fas fa-bell"></i></span>
                    </div>
                    <hr>
                </div>
                <div class="MainInTab PersonalTabWindow">
                    <div class="PersonalOverviewHeader">
                        <div class="GenderFab Female">&#9792;</div>
                        <img class="Avatar" src="{{ current_user.avatar }}"
                             data-caching-key="{{ current_user.user_name }}_avatar_cached" />
                        <div class="GenderFab Male">&#9794;</div>
                    </div>
                    <br>
                    <div class="DisplayNames">
                        <span class="FullName">{{ current_user.full_name }}</span> {# TODO: Onclick edit popup #}
                        <br>
                        <small class="Username">{{ current_user.user_name }}</small>
                    </div>
                    <br>
                    <hr class="ShorterLine" align="center">

                    <br>
                    <div class="EditProfileForm">
                        <p class="EditFieldLabel">{{ translate('USERNAME') }}</p>
                        <p class="EditFieldText">{{ current_user.user_name }}</p><br>

                        <p class="EditFieldLabel">{{ translate('EMAIL') }}</p>
                        <p class="EditFieldText">{{ current_user.email }}</p><br>

                        <p class="EditFieldLabel">{{ translate('LOCALE') }}</p>
                        <p class="EditFieldText">{{ site.locales.available[current_user.locale] }}</p><br> {# more in admin/templates/forms/user.html.twig #}

                        <p class="EditFieldLabel">{{ translate('THEME') }}</p>
                        <p class="EditFieldText">{{ current_user.theme }}</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="Navbar">
            <span id="0" class="NavbarIconWrap">
                <img src="{{ assets.url('assets://SiteAssets/icons/FriendFeedOutline.svg') }}">
            </span>
            <span id="1" class="NavbarIconWrap">
                <img src="{{ assets.url('assets://SiteAssets/icons/ExploreGlobeOutline.svg') }}">
            </span>
            <span id="2" class="NavbarIconWrap ActiveTab">
                <img src="{{ assets.url('assets://SiteAssets/icons/MessageBubbleOutlineActivated.svg') }}">
            </span>
            <span id="3" class="NavbarIconWrap">
                <img src="{{ assets.url('assets://SiteAssets/icons/UserGroupOutline.svg') }}">
            </span>
            <span id="4" class="NavbarIconWrap">
                <img src="{{ assets.url('assets://SiteAssets/icons/UserOutline.svg') }}">
            </span>
        </div>
        <span class='NavbarLine'></span>
    </div>
{% endblock %}

{% block scripts_page %}
    <script id="uf-alert-template" type="text/x-handlebars-template">
        <div class="alert alert-{{ type }} alert-dismissible uf-alert">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
            <i class="icon fa fa-fw {{ icon }} pull-left"></i>
            <div class="uf-alert-message-container">{{ message }}</div>
        </div>
    </script>
    <script>
        const NotifySound = new Audio("{{ assets.url('assets://SiteAssets/notisound.mp3') }}");

        // translation service
        function ReplaceServerMessage(Type) {
            let Username;
            const LastServerMessage = $(".MessageWrapper:last .ServerChatMessage");
            if (Type === "YouGroupJoin") {
                const GroupName = LastServerMessage.text();
                LastServerMessage.text("{{ translate("CHAT_MESSAGES.YOU_GROUP_JOIN", {group: "ConvertTranslatedMessageWithGroupName"}) }}".replace("ConvertTranslatedMessageWithGroupName", '"' + GroupName + '"') + ".");
            } else if (Type === "UserGroupJoin") {
                Username = LastServerMessage.text();
                LastServerMessage.text("{{ translate("CHAT_MESSAGES.USER_GROUP_JOIN", {user: "ConvertTranslatedMessageWithUsername"}) }}".replace("ConvertTranslatedMessageWithUsername", Username) + ".");
            } else if (Type === "UserDisconnect") {
                Username = LastServerMessage.text();
                LastServerMessage.text("{{ translate("CHAT_MESSAGES.USER_DISCONNECT", {user: "ConvertTranslatedMessageWithUsername"}) }}".replace("ConvertTranslatedMessageWithUsername", Username) + ".");
            }
        }
    </script>
{% endblock %}
